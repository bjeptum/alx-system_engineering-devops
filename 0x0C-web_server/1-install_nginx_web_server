#!/usr/bin/env bash
# Configure Ubuntu machine
sudo apt-get install -y build-essential
sudo apt-get install -y software-properties-common
sudo add-apt-repository ppa:ondrej/php
sudo apt-get update
sudo apt-get install -y php7.4
sudo apt-get install -y php7.4-cli
sudo apt-get install -y php7.4-fpm
sudo apt-get install -y php7.4-common
sudo apt-get install -y php7.4-curl
sudo apt-get install -y php7.4-gd
sudo apt-get install -y php7.4-mbstring
sudo apt-get install -y php7.4-mysql
sudo apt-get install -y php7.4-xml
sudo apt-get install -y php7.4-zip
sudo service restart php7.4-fpm

# Install Nginx
sudo apt-get update
sudo apt-get install -y nginx

#Adjust the firewall
sudo ufw allow 'Nginx HTTP'

# Configure Nginx to listen on port 80
sudo sed -i 's/listen 80 default_server;/listen 80;/' /etc/nginx/sites-available/default

#Configure Nginx to return "Hello World!" at the root path
echo "Hello World!" > /var/www/html/index.html

# Enable the new site
sudo ln -s /etc/nginx/sites-available/hello-world /etc/nginx/sites-enabled/hello-world

# Restart Nginx
sudo service Nginx restart
